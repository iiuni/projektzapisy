{% extends 'schedule/events_report.html' %}
{% load render_bundle from webpack_loader %}
{% load schedule_filters %}
{% load staticfiles %}

{% block events_report %} class="active"{% endblock %}

{% block bread %}
    <li class="breadcrumb-item"><a href="{% url 'main-page' %}">Strona główna</a></li>
    <li class="breadcrumb-item"><a href="{% url 'events:classrooms' %}">Sale</a></li>
    <li class="breadcrumb-item"><a href="{% url 'events:events_report' %}">Raporty</a></li>
    <li class="breadcrumb-item active" aria-current="page">Wydruki na sale</li>
{% endblock %}

{% block reporttitle %}{% endblock %}

{% block all-content %}
  <div class='mb-5 d-print-none'>
      <a class="btn btn-light print-report float-right">
          <i class="fa fa-print"></i>
          Drukuj
      </a>
  </div>
  <style>
      #room_terms_id {
        font-size: 1.25rem;
      }
      p {
        margin-bottom: 0.5rem;
      }
      @page {
        margin: 0.5cm 2cm 2cm 2cm;
      }
      @media print {
        footer { page-break-after: always; }
        .ct-app { display: none; }
      }
      header #logo_id { 
        width: 280px;
        filter: invert(1);
      }
      .display-1 {
        font-size: 4rem
      }
      b, strong {
        display: inline-block;
        width: 5em;
      }
  </style>

  {% for room, terms_list in events %}
    <div class="report-page pt-5">
      <header class="d-flex justify-content-between align-items-center">
        <h1 class="display-1">{{ room }}</h1>
        <h3 class="display-3">Semestr {{ semester.get_type_display }} &mdash; {{ semester.year }}</h3>
        <img src="{% static 'images/logo_UWr.svg' %}" id="logo_id" alt="uwrlogo" align="right">
      </header>
      <section data-editable data-name="report-page-{{ room }}" id="room_terms_id">
          {% for term in terms_list %}
            <p>
              <strong>{{term.day|date:'w'|number_to_weekday}} {{term.start|time:'G'}}&ndash;{{term.end|time:'G'}}</strong>
              {% if term.title %}
                {% if term.title|length > 0 %}
                  {{ term.title|upper }}
                {% else %}
                  &lt;brak nazwy&gt;
                {% endif %}
              {% else %}
                {% with term.event.title.strip as evt_title %}
                  {% if evt_title|length > 0 %}
                    {{ evt_title|upper }}
                  {% else %}
                    &lt;brak nazwy&gt;
                  {% endif %}
                {% endwith %}
              {% endif %}
                {% with term.event.group.human_readable_type as evt_type %}
                  {% if evt_type|length > 0 %}
                    ({{ evt_type|lower }})
                  {% endif %}
              {% endwith %}
              {{term.event.author.get_full_name|upper}}
            </p>
          {% endfor %}
        </div>
      </section>
      <footer></footer>
  {% endfor %}
{% endblock %}

{% block rendered_bundles %}
    {% render_bundle "schedule-report" %}
    {% render_bundle "schedule-report-editor" %}
{% endblock %}

