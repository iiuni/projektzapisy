{% extends 'schedule/events_report.html' %}
{% load render_bundle from webpack_loader %}
{% load static %}
{% load compressed %}

{% block events_report %} class="active"{% endblock %}

{% block bread %}
    <li class="breadcrumb-item"><a href="{% url 'main-page' %}">Strona główna</a></li>
    <li class="breadcrumb-item"><a href="{% url 'events:classrooms' %}">Sale</a></li>
    <li class="breadcrumb-item active" aria-current="page">Raport</li>
{% endblock %}

{% block js %}{{ block.super }}
    <link rel="stylesheet" type="text/css" href="/static/admin/css/forms.css" />
    <script type="text/javascript" src="{% url 'admin:jsi18n' %}"></script>
    {% compressed_js 'proposal_edit' %}
        <script id="filtered-select-multiple-data" type="application/json">
[{
   "id": "#selector-widget",
   "size": 15,
   "txtAvailable": "Sale",
   "txtChosen": "Wybrane"
}]
    </script>
    {% render_bundle "filtered-select-multiple-converter" %}
    {% render_bundle "schedule-report" %}
{% endblock %}

{% block reporttitle %}Raport zwykły{% endblock %}

{% block reportformview %}
    <form action="{% url 'events:events_report_date' %}" method="post" id="reportForm">
        {% csrf_token %}
        {{ form.non_field_errors }}
        {% for hidden in form.hidden_fields %}
            {{ hidden }}
        {% endfor %}

        <div class="mb-4 d-print-none">
            <div id="selector-widget" class="p-1 flex-fill w-100 mt-3">
            {{ form.rooms }}
            {{ form.rooms.errors }}
            </div>
            <input type="button" id="select-all-button" class="btn btn-outline-dark ml-2" value="Zaznacz wszystkie">
        </div>

        <div class="input-group mb-4 d-print-none">
            <div class="input-group-prepend">
                <label class="input-group-text">{{ form.beg_date.label }}</label>
            </div>
            {{ form.beg_date }}
            <div class="input-group-prepend input-group-append">
                <label class="input-group-text">{{ form.end_date.label }}</label>
            </div>
            {{ form.end_date }}
        </div>

        <div class="input-group d-print-none">
            <input type="submit" value="Generuj raport" class="btn btn-success btn-lg btn-block">
        </div>
    </form>

    {% if request.user.is_authenticated %}  
        <a class="btn btn-info mt-2 d-print-none" data-toggle="collapse"  href="#report-file"    
        role="button" aria-expanded="false" aria-controls="report-preview">   
            Podgląd 
        </a>
        <a class="btn btn-light mt-2 d-print-none" href="#" id="print">
            <i class="fa fa-print"></i>
            Drukuj
        </a>
        <div class="collapse mt-3 d-print-block" id="report-file">
            <div id="report-preview">
                {% include 'schedule/events_report_date_pdf.html' %}
            </div>
        </div>
    {% endif %}
    
{% endblock %}
